#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
ğŸ¤– Ø¨ÙˆØª Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØªØ·ÙˆØ± v2.0
Telegram Protection Bot - Fixed Version

âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Middleware
âœ… ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª
"""

import telebot
from telebot import types, apihelper
import time
import json
import os
from datetime import datetime
import logging

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”§ ØªÙØ¹ÙŠÙ„ Middleware (Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹!)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
apihelper.ENABLE_MIDDLEWARE = True

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª - Ø¶Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ù‡Ù†Ø§
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TOKEN = "8042868100:AAE-vqTcOOwBo8DT1JtCNT0BynmBeXkH4UE"
CHANNEL_USERNAME = "@techaii"
DEVELOPER_ID = 6291244851

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DATABASE_FILE = "bot_data.json"
DEFAULT_PROTECTION = True
MAX_DELETE_MESSAGES = 100
BROADCAST_DELAY = 0.05

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù„Ø³Ø¬Ù„Ø§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙˆØª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

bot = telebot.TeleBot(TOKEN)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def load_data():
    """ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù JSON"""
    if os.path.exists(DATABASE_FILE):
        try:
            with open(DATABASE_FILE, 'r', encoding='utf-8') as f:
                return json.load(f)
        except Exception as e:
            logger.error(f"Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: {e}")
    return {
        "groups_list": [],
        "users_list": [],
        "chat_protection": {},
        "user_warnings": {}
    }

def save_data():
    """Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù JSON"""
    try:
        data = {
            "groups_list": list(groups_list),
            "users_list": list(users_list),
            "chat_protection": chat_protection,
            "user_warnings": user_warnings
        }
        with open(DATABASE_FILE, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
        logger.info("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­")
    except Exception as e:
        logger.error(f"Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: {e}")

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
logger.info("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...")
data = load_data()
groups_list = set(data.get("groups_list", []))
users_list = set(data.get("users_list", []))
chat_protection = data.get("chat_protection", {})
user_warnings = data.get("user_warnings", {})
logger.info(f"ØªÙ… ØªØ­Ù…ÙŠÙ„ {len(users_list)} Ù…Ø³ØªØ®Ø¯Ù… Ùˆ {len(groups_list)} Ù…Ø¬Ù…ÙˆØ¹Ø©")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def is_developer(user_id):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ Ø§Ù„Ù…Ø·ÙˆØ±"""
    return user_id == DEVELOPER_ID

def is_subscribed(user_id):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©"""
    if is_developer(user_id):
        return True
    try:
        status = bot.get_chat_member(CHANNEL_USERNAME, user_id).status
        return status in ["member", "administrator", "creator"]
    except Exception as e:
        logger.warning(f"Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ: {e}")
        return False

def is_admin(chat_id, user_id):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø´Ø±Ù ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©"""
    if is_developer(user_id):
        return True
    try:
        member = bot.get_chat_member(chat_id, user_id)
        return member.status in ["administrator", "creator"]
    except:
        return False

def is_bot_admin(chat_id):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø¨ÙˆØª Ù…Ø´Ø±Ù ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©"""
    try:
        bot_member = bot.get_chat_member(chat_id, bot.get_me().id)
        return bot_member.status in ["administrator", "creator"]
    except:
        return False

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.middleware_handler(update_types=['message'])
def check_subscription(bot_instance, message):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ù‚Ø¨Ù„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙŠ Ø±Ø³Ø§Ù„Ø©"""
    if message.chat.type != "private":
        return
    
    if message.text and message.text.startswith('/start'):
        return
    
    if not is_subscribed(message.from_user.id):
        markup = types.InlineKeyboardMarkup()
        markup.add(types.InlineKeyboardButton(
            "Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ø§Ø´ØªØ±Ø§Ùƒ ğŸ“¢", 
            url=f"https://t.me/{CHANNEL_USERNAME.replace('@', '')}"
        ))
        markup.add(types.InlineKeyboardButton(
            "ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ âœ…", 
            callback_data="check_subscription"
        ))
        bot.send_message(
            message.chat.id,
            f"âš ï¸ Ø¹Ø°Ø±Ø§Ù‹ Ø¹Ø²ÙŠØ²ÙŠØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª Ø£ÙˆÙ„Ø§Ù‹:\n\n"
            f"ğŸ“¢ Ø§Ù„Ù‚Ù†Ø§Ø©: {CHANNEL_USERNAME}\n\n"
            f"Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ' âœ…",
            reply_markup=markup
        )
        return False

@bot.callback_query_handler(func=lambda call: call.data == "check_subscription")
def verify_subscription(call):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±"""
    if is_subscribed(call.from_user.id):
        bot.answer_callback_query(call.id, "âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª", show_alert=True)
        bot.delete_message(call.message.chat.id, call.message.message_id)
        bot.send_message(
            call.message.chat.id, 
            "ğŸ‰ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª.\n"
            "Ø§Ø³ØªØ®Ø¯Ù… /Ø§ÙˆØ§Ù…Ø± Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©."
        )
    else:
        bot.answer_callback_query(
            call.id, 
            "âŒ Ù„Ù… ØªÙ‚Ù… Ø¨Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø¹Ø¯! Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© Ø£ÙˆÙ„Ø§Ù‹", 
            show_alert=True
        )

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø£Ù…Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.message_handler(commands=["start"])
def start(message):
    """Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨"""
    user_id = message.from_user.id
    users_list.add(user_id)
    save_data()
    
    if message.chat.type == "private" and not is_subscribed(user_id):
        markup = types.InlineKeyboardMarkup()
        markup.add(types.InlineKeyboardButton(
            "Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ø§Ø´ØªØ±Ø§Ùƒ ğŸ“¢", 
            url=f"https://t.me/{CHANNEL_USERNAME.replace('@', '')}"
        ))
        markup.add(types.InlineKeyboardButton(
            "ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ âœ…", 
            callback_data="check_subscription"
        ))
        bot.send_message(
            message.chat.id,
            f"âš ï¸ Ø¹Ø°Ø±Ø§Ù‹ Ø¹Ø²ÙŠØ²ÙŠØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª Ø£ÙˆÙ„Ø§Ù‹:\n\n"
            f"ğŸ“¢ Ø§Ù„Ù‚Ù†Ø§Ø©: {CHANNEL_USERNAME}\n\n"
            f"Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ' âœ…",
            reply_markup=markup
        )
        return
    
    if is_developer(user_id):
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
        markup.add("ğŸ“Š Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØª", "ğŸ“¤ Ø§Ø°Ø§Ø¹Ø© Ù„Ù„ÙƒÙ„")
        markup.add("ğŸ”„ ØªØ­Ø¯ÙŠØ«", "ğŸ”š Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª")
        bot.reply_to(message, "ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ø³ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø·ÙˆØ± ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ….", reply_markup=markup)
    else:
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
        markup.add("ğŸ“‹ Ø§Ù„Ø£ÙˆØ§Ù…Ø±", "â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠ")
        bot.send_message(
            message.chat.id,
            "ğŸ¤– Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±!\n\n"
            "âœ¨ Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ø¬Ù…ÙˆØ¹Ø§ØªÙƒ Ù…Ù† Ø§Ù„Ø³Ø¨Ø§Ù… ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©\n\n"
            "ğŸ“ Ø§Ø³ØªØ®Ø¯Ù… /Ø§ÙˆØ§Ù…Ø± Ù„Ù…Ø¹Ø±ÙØ© Ù…Ø§ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ÙØ¹Ù„Ù‡",
            reply_markup=markup
        )

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø±
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.message_handler(commands=["Ø§ÙˆØ§Ù…Ø±", "help"])
def help_cmds(message):
    """Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø±"""
    help_text = """
ğŸ›¡ï¸ **Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¥Ø´Ø±Ø§Ù (Ù„Ù„Ù…Ø´Ø±ÙÙŠÙ† ÙÙ‚Ø·):**

**Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡:**
â€¢ `Ø­Ø¸Ø±` - Ù„Ø­Ø¸Ø± Ø¹Ø¶Ùˆ Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© (Ø¨Ø§Ù„Ø±Ø¯)
â€¢ `ÙƒØªÙ…` - Ù„Ù…Ù†Ø¹ Ø¹Ø¶Ùˆ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Ø¨Ø§Ù„Ø±Ø¯)
â€¢ `Ø§Ù„ØºØ§Ø¡ ÙƒØªÙ…` - Ù„Ø¥Ù„ØºØ§Ø¡ ÙƒØªÙ… Ø¹Ø¶Ùˆ (Ø¨Ø§Ù„Ø±Ø¯)
â€¢ `Ø·Ø±Ø¯` - Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø¹Ø¶Ùˆ Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© (Ø¨Ø§Ù„Ø±Ø¯)
â€¢ `Ø§Ù„ØºØ§Ø¡ Ø­Ø¸Ø±` - Ù„Ø¥Ù„ØºØ§Ø¡ Ø­Ø¸Ø± Ø¹Ø¶Ùˆ (Ø¨Ø§Ù„Ø±Ø¯)

**Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰:**
â€¢ `ØªØ«Ø¨ÙŠØª` - Ù„ØªØ«Ø¨ÙŠØª Ø±Ø³Ø§Ù„Ø© (Ø¨Ø§Ù„Ø±Ø¯)
â€¢ `Ø§Ù„ØºØ§Ø¡ ØªØ«Ø¨ÙŠØª` - Ù„Ø¥Ù„ØºØ§Ø¡ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø±Ø³Ø§Ù„Ø©
â€¢ `Ù…Ø³Ø­ [Ø¹Ø¯Ø¯]` - Ù„Ø­Ø°Ù Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Ù…Ø«Ø§Ù„: Ù…Ø³Ø­ 10)

**Ø§Ù„Ø­Ù…Ø§ÙŠØ©:**
â€¢ `ØªÙØ¹ÙŠÙ„` - Ù„ØªÙØ¹ÙŠÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
â€¢ `ØªØ¹Ø·ÙŠÙ„` - Ù„ØªØ¹Ø·ÙŠÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©

ğŸ‘¤ **Ø£ÙˆØ§Ù…Ø± Ø¹Ø§Ù…Ø©:**
â€¢ `Ø§ÙŠØ¯ÙŠ` - Ù„Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ
â€¢ `Ø±ØªØ¨ØªÙŠ` - Ù„Ù…Ø¹Ø±ÙØ© ØµÙ„Ø§Ø­ÙŠØ§ØªÙƒ
â€¢ `/start` - Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªÙØ§Ø¹Ù„

ğŸ“Œ **Ù…Ù„Ø§Ø­Ø¸Ø©:** Ù…Ø¹Ø¸Ù… Ø§Ù„Ø£ÙˆØ§Ù…Ø± ØªØ¹Ù…Ù„ Ø¨Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ø¶Ùˆ
"""
    bot.reply_to(message, help_text, parse_mode="Markdown")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.message_handler(func=lambda m: m.text in ["ğŸ“‹ Ø§Ù„Ø£ÙˆØ§Ù…Ø±", "â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠ"] and m.chat.type == "private")
def user_buttons(message):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"""
    if message.text == "ğŸ“‹ Ø§Ù„Ø£ÙˆØ§Ù…Ø±":
        help_cmds(message)
    elif message.text == "â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠ":
        user_id = message.from_user.id
        rank = "Ù…Ø·ÙˆØ± ğŸ‘¨â€ğŸ’»" if is_developer(user_id) else "Ù…Ø³ØªØ®Ø¯Ù… ğŸ‘¤"
        bot.reply_to(
            message,
            f"ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: {message.from_user.first_name}\n"
            f"ğŸ†” Ø§Ù„Ø§ÙŠØ¯ÙŠ: `{user_id}`\n"
            f"ğŸ–ï¸ Ø§Ù„Ø±ØªØ¨Ø©: {rank}\n"
            f"ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: {datetime.now().strftime('%Y-%m-%d')}",
            parse_mode="Markdown"
        )

@bot.message_handler(func=lambda m: is_developer(m.from_user.id) and m.chat.type == "private")
def developer_panel(message):
    """Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±"""
    text = message.text
    
    if text == "ğŸ“Š Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØª":
        stats_text = (
            f"ğŸ“ˆ **Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØª:**\n\n"
            f"ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: **{len(users_list)}**\n"
            f"ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª: **{len(groups_list)}**\n"
            f"ğŸ›¡ï¸ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù…Ø­Ù…ÙŠØ©: **{sum(1 for v in chat_protection.values() if v)}**\n"
            f"ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: {datetime.now().strftime('%Y-%m-%d %H:%M')}"
        )
        bot.reply_to(message, stats_text, parse_mode="Markdown")
    
    elif text == "ğŸ“¤ Ø§Ø°Ø§Ø¹Ø© Ù„Ù„ÙƒÙ„":
        msg = bot.reply_to(message, "ğŸ“ Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø§Ù„Ø¢Ù†:")
        bot.register_next_step_handler(msg, perform_broadcast)
    
    elif text == "ğŸ”„ ØªØ­Ø¯ÙŠØ«":
        bot.reply_to(message, "ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...")
        save_data()
        bot.send_message(message.chat.id, "âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«!")
    
    elif text == "ğŸ”š Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª":
        markup = types.InlineKeyboardMarkup()
        markup.add(
            types.InlineKeyboardButton("âœ… Ù†Ø¹Ù…", callback_data="stop_bot_yes"),
            types.InlineKeyboardButton("âŒ Ù„Ø§", callback_data="stop_bot_no")
        )
        bot.send_message(message.chat.id, "âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ", reply_markup=markup)

@bot.callback_query_handler(func=lambda call: call.data.startswith("stop_bot_"))
def stop_bot_callback(call):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‚Ø±Ø§Ø± Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª"""
    if call.data == "stop_bot_yes" and is_developer(call.from_user.id):
        bot.answer_callback_query(call.id, "ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª")
        bot.send_message(call.message.chat.id, "ğŸ”´ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª...")
        save_data()
        bot.stop_polling()
    else:
        bot.answer_callback_query(call.id, "ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡")
        bot.delete_message(call.message.chat.id, call.message.message_id)

def perform_broadcast(message):
    """ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø°Ø§Ø¹Ø©"""
    if not message.text:
        bot.reply_to(message, "âŒ ÙŠØ¬Ø¨ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ©!")
        return
    
    success_count = 0
    fail_count = 0
    status_msg = bot.reply_to(message, "ğŸ“¤ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...")
    
    for user in users_list:
        try:
            bot.send_message(user, message.text)
            success_count += 1
            time.sleep(BROADCAST_DELAY)
        except:
            fail_count += 1
    
    bot.edit_message_text(
        f"âœ… **ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø©!**\n\nâœ”ï¸ Ù†Ø¬Ø­: {success_count}\nâŒ ÙØ´Ù„: {fail_count}",
        status_msg.chat.id,
        status_msg.message_id,
        parse_mode="Markdown"
    )
    save_data()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.message_handler(func=lambda m: m.chat.type in ["group", "supergroup"])
def group_commands(message):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª"""
    chat_id = message.chat.id
    user_id = message.from_user.id
    text = message.text
    
    groups_list.add(chat_id)
    save_data()
    
    chat_id_str = str(chat_id)
    
    if text and text.strip() == "Ø§ÙŠØ¯ÙŠ":
        rank = "Ù…Ø·ÙˆØ± ğŸ‘¨â€ğŸ’»" if is_developer(user_id) else (
            "Ù…Ø´Ø±Ù ğŸ›¡ï¸" if is_admin(chat_id, user_id) else "Ø¹Ø¶Ùˆ ğŸ‘¤"
        )
        bot.reply_to(
            message,
            f"ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: {message.from_user.first_name}\n"
            f"ğŸ†” Ø§Ù„Ø§ÙŠØ¯ÙŠ: `{user_id}`\n"
            f"ğŸ–ï¸ Ø§Ù„Ø±ØªØ¨Ø©: {rank}",
            parse_mode="Markdown"
        )
        return
    
    if text and text.strip() == "Ø±ØªØ¨ØªÙŠ":
        rank = "Ù…Ø·ÙˆØ± ğŸ‘¨â€ğŸ’»" if is_developer(user_id) else (
            "Ù…Ø´Ø±Ù ğŸ›¡ï¸" if is_admin(chat_id, user_id) else "Ø¹Ø¶Ùˆ ğŸ‘¤"
        )
        bot.reply_to(message, f"ğŸ–ï¸ Ø±ØªØ¨ØªÙƒ: {rank}")
        return
    
    if not is_admin(chat_id, user_id):
        check_protection(message)
        return
    
    if not is_bot_admin(chat_id):
        if text in ["Ø­Ø¸Ø±", "ÙƒØªÙ…", "Ø·Ø±Ø¯", "ØªØ«Ø¨ÙŠØª", "Ù…Ø³Ø­", "ØªÙØ¹ÙŠÙ„", "ØªØ¹Ø·ÙŠÙ„"]:
            bot.reply_to(message, "âš ï¸ ÙŠØ¬Ø¨ Ø£Ù† Ø£ÙƒÙˆÙ† Ù…Ø´Ø±ÙØ§Ù‹!")
        return
    
    if text == "ØªÙØ¹ÙŠÙ„":
        chat_protection[chat_id_str] = True
        save_data()
        bot.reply_to(message, "âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ù…Ø§ÙŠØ©.")
    
    elif text == "ØªØ¹Ø·ÙŠÙ„":
        chat_protection[chat_id_str] = False
        save_data()
        bot.reply_to(message, "âŒ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø­Ù…Ø§ÙŠØ©.")
    
    elif message.reply_to_message:
        target_id = message.reply_to_message.from_user.id
        target_name = message.reply_to_message.from_user.first_name
        
        if is_admin(chat_id, target_id) or is_developer(target_id):
            bot.reply_to(message, "âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ØªÙ†ÙÙŠØ° Ù‡Ø°Ø§ Ø¹Ù„Ù‰ Ù…Ø´Ø±Ù!")
            return
        
        if text == "Ø­Ø¸Ø±":
            try:
                bot.ban_chat_member(chat_id, target_id)
                bot.reply_to(message, f"ğŸš« ØªÙ… Ø­Ø¸Ø± {target_name}.")
            except Exception as e:
                bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
        
        elif text == "ÙƒØªÙ…":
            try:
                bot.restrict_chat_member(chat_id, target_id, can_send_messages=False)
                bot.reply_to(message, f"ğŸ”‡ ØªÙ… ÙƒØªÙ… {target_name}.")
            except Exception as e:
                bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
        
        elif text == "Ø§Ù„ØºØ§Ø¡ ÙƒØªÙ…":
            try:
                bot.restrict_chat_member(
                    chat_id, target_id,
                    can_send_messages=True,
                    can_send_media_messages=True,
                    can_send_other_messages=True,
                    can_add_web_page_previews=True
                )
                bot.reply_to(message, f"ğŸ”Š ØªÙ… Ø¥Ù„ØºØ§Ø¡ ÙƒØªÙ… {target_name}.")
            except Exception as e:
                bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
        
        elif text == "Ø·Ø±Ø¯":
            try:
                bot.ban_chat_member(chat_id, target_id)
                time.sleep(1)
                bot.unban_chat_member(chat_id, target_id)
                bot.reply_to(message, f"ğŸ‘ ØªÙ… Ø·Ø±Ø¯ {target_name}.")
            except Exception as e:
                bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
        
        elif text == "Ø§Ù„ØºØ§Ø¡ Ø­Ø¸Ø±":
            try:
                bot.unban_chat_member(chat_id, target_id)
                bot.reply_to(message, f"âœ… ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø­Ø¸Ø± {target_name}.")
            except Exception as e:
                bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
        
        elif text == "ØªØ«Ø¨ÙŠØª":
            try:
                bot.pin_chat_message(chat_id, message.reply_to_message.message_id)
                bot.reply_to(message, "ğŸ“Œ ØªÙ… Ø§Ù„ØªØ«Ø¨ÙŠØª.")
            except Exception as e:
                bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
    
    elif text == "Ø§Ù„ØºØ§Ø¡ ØªØ«Ø¨ÙŠØª":
        try:
            bot.unpin_chat_message(chat_id)
            bot.reply_to(message, "ğŸ“Œ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª.")
        except Exception as e:
            bot.reply_to(message, f"âŒ ÙØ´Ù„: {str(e)}")
    
    elif text and text.startswith("Ù…Ø³Ø­ "):
        try:
            parts = text.split()
            if len(parts) != 2:
                bot.reply_to(message, "âŒ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: Ù…Ø³Ø­ [Ø¹Ø¯Ø¯]\nÙ…Ø«Ø§Ù„: Ù…Ø³Ø­ 10")
                return
            
            num = int(parts[1])
            
            if num < 1 or num > MAX_DELETE_MESSAGES:
                bot.reply_to(message, f"âš ï¸ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 1 Ùˆ {MAX_DELETE_MESSAGES}")
                return
            
            deleted = 0
            current_msg_id = message.message_id
            
            for i in range(num + 1):
                try:
                    bot.delete_message(chat_id, current_msg_id - i)
                    deleted += 1
                    time.sleep(0.1)
                except:
                    pass
            
            confirm_msg = bot.send_message(chat_id, f"ğŸ§¹ ØªÙ… Ù…Ø³Ø­ {deleted} Ø±Ø³Ø§Ù„Ø©.")
            time.sleep(3)
            try:
                bot.delete_message(chat_id, confirm_msg.message_id)
            except:
                pass
            
        except ValueError:
            bot.reply_to(message, "âŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­!\nÙ…Ø«Ø§Ù„: Ù…Ø³Ø­ 10")
        except Exception as e:
            bot.reply_to(message, f"âŒ Ø®Ø·Ø£: {str(e)}")

def check_protection(message):
    """ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰"""
    chat_id = message.chat.id
    chat_id_str = str(chat_id)
    
    if chat_protection.get(chat_id_str, DEFAULT_PROTECTION):
        if not message.text:
            return
        
        suspicious_patterns = ["t.me/", "http://", "https://", "telegram.me/"]
        
        if any(pattern in message.text.lower() for pattern in suspicious_patterns):
            try:
                bot.delete_message(chat_id, message.message_id)
                warning_msg = bot.send_message(
                    chat_id,
                    f"âš ï¸ {message.from_user.first_name}ØŒ Ù…Ù…Ù†ÙˆØ¹ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·!"
                )
                time.sleep(5)
                try:
                    bot.delete_message(chat_id, warning_msg.message_id)
                except:
                    pass
            except Exception as e:
                logger.warning(f"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù: {e}")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.message_handler(content_types=['new_chat_members'])
def welcome_new_members(message):
    """Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯"""
    for new_member in message.new_chat_members:
        if new_member.id == bot.get_me().id:
            bot.send_message(
                message.chat.id,
                "ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¥Ø¶Ø§ÙØªÙŠ\n\n"
                "ğŸ›¡ï¸ Ø£Ù†Ø§ Ø¨ÙˆØª Ø­Ù…Ø§ÙŠØ© Ù…ØªØ·ÙˆØ±\n"
                "âš™ï¸ Ø§Ø¬Ø¹Ù„Ù†ÙŠ Ù…Ø´Ø±ÙØ§Ù‹ Ù„Ø£Ø­Ù…ÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©\n\n"
                "ğŸ“ Ø§Ø³ØªØ®Ø¯Ù… /Ø§ÙˆØ§Ù…Ø± Ù„Ù„Ø£ÙˆØ§Ù…Ø±"
            )
        else:
            bot.send_message(
                message.chat.id,
                f"ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ {new_member.first_name}!\n"
                f"Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ÙˆÙ‚ØªØ§Ù‹ Ù…Ù…ØªØ¹Ø§Ù‹ ğŸŒŸ"
            )

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù…Ø¹Ø§Ù„Ø¬ Ø§Ø­ØªÙŠØ§Ø·ÙŠ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@bot.message_handler(func=lambda message: True, content_types=['text'])
def catch_all(message):
    """Ù…Ø¹Ø§Ù„Ø¬ Ø§Ø­ØªÙŠØ§Ø·ÙŠ"""
    if message.chat.type == "private":
        bot.reply_to(
            message,
            "â“ Ù„Ù… Ø£ÙÙ‡Ù… Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±.\n"
            "Ø§Ø³ØªØ®Ø¯Ù… /Ø§ÙˆØ§Ù…Ø± Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø£ÙˆØ§Ù…Ø±."
        )

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if __name__ == "__main__":
    print("\n" + "="*80)
    print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘              ğŸ¤– Ø¨ÙˆØª Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ù…ØªØ·ÙˆØ± v2.0 - Fixed ğŸ¤–               â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print("="*80)
    print("\nğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„...")
    print(f"ğŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ {len(users_list)} Ù…Ø³ØªØ®Ø¯Ù… Ùˆ {len(groups_list)} Ù…Ø¬Ù…ÙˆØ¹Ø©")
    print(f"ğŸ“¢ Ù‚Ù†Ø§Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ: {CHANNEL_USERNAME}")
    print(f"ğŸ‘¨â€ğŸ’» Ø§ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø·ÙˆØ±: {DEVELOPER_ID}")
    print("\nâœ… Middleware: Ù…ÙÙØ¹Ù‘Ù„")
    print("ğŸŸ¢ Ø§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† Ø¨Ù†Ø¬Ø§Ø­...")
    print("â³ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„...\n")
    print("ğŸ’¡ Ù„Ù„Ø¥ÙŠÙ‚Ø§Ù: Ctrl+C\n")
    print("="*80 + "\n")
    
    try:
        bot.infinity_polling(timeout=60, long_polling_timeout=60)
    except KeyboardInterrupt:
        print("\n" + "="*80)
        print("ğŸ›‘ ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù")
        save_data()
        print("ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
        print("ğŸ‘‹ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‚Ø§Ø¡!")
        print("="*80 + "\n")
    except Exception as e:
        print("\n" + "="*80)
        print(f"âŒ Ø®Ø·Ø£: {e}")
        save_data()
        print("ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
        print("="*80 + "\n")
from flask import Flask
import threading

app = Flask('')

@app.route('/')
def home():
    return "Ø³ÙŠÙ„ÙØ± ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­!"

def run():
    app.run(host='0.0.0.0', port=8080)

def start_bot():
    bot.infinity_polling()

if __name__ == "__main__":
    # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙÙŠ Ø®Ù„ÙÙŠØ© Ù…Ù†ÙØµÙ„Ø©
    t = threading.Thread(target=run)
    t.start()
    # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
    start_bot()
